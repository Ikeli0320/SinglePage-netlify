<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terra Narrativa - åŠŸèƒ½æ¸¬è©¦</title>
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }

        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .test-item {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .test-item h3 {
            color: #8B4513;
            margin-top: 0;
        }

        .status {
            padding: 5px 10px;
            border-radius: 3px;
            font-weight: bold;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
        }

        .status.warning {
            background: #fff3cd;
            color: #856404;
        }

        .btn {
            background: #8B4513;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }

        .btn:hover {
            background: #A0522D;
        }
    </style>
</head>

<body>
    <div class="test-container">
        <h1>ğŸ§ª ç¾æ¨‚åœ°ç”¢ åŠŸèƒ½æ¸¬è©¦</h1>

        <div class="test-item">
            <h3>1. æª”æ¡ˆå®Œæ•´æ€§æª¢æŸ¥</h3>
            <div id="file-check">
                <p>æª¢æŸ¥ä¸­...</p>
            </div>
        </div>

        <div class="test-item">
            <h3>2. å¤–éƒ¨è³‡æºè¼‰å…¥æ¸¬è©¦</h3>
            <div id="resource-check">
                <p>æª¢æŸ¥ä¸­...</p>
            </div>
        </div>

        <div class="test-item">
            <h3>3. JavaScript åŠŸèƒ½æ¸¬è©¦</h3>
            <div id="js-check">
                <p>æª¢æŸ¥ä¸­...</p>
            </div>
        </div>

        <div class="test-item">
            <h3>4. åœ°åœ–åŠŸèƒ½æ¸¬è©¦</h3>
            <div id="map-check">
                <p>æª¢æŸ¥ä¸­...</p>
            </div>
        </div>

        <div class="test-item">
            <h3>5. éŸ¿æ‡‰å¼è¨­è¨ˆæ¸¬è©¦</h3>
            <div id="responsive-check">
                <p>æª¢æŸ¥ä¸­...</p>
            </div>
        </div>

        <div class="test-item">
            <h3>æ¸¬è©¦çµæœ</h3>
            <div id="test-results">
                <p>ç­‰å¾…æ¸¬è©¦å®Œæˆ...</p>
            </div>
            <button class="btn" onclick="runAllTests()">é‡æ–°åŸ·è¡Œæ¸¬è©¦</button>
            <button class="btn" onclick="window.open('index.html', '_blank')">é–‹å•Ÿä¸»æ‡‰ç”¨</button>
        </div>
    </div>

    <script>
        let testResults = {
            files: false,
            resources: false,
            javascript: false,
            map: false,
            responsive: false
        };

        function updateStatus(elementId, status, message) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<span class="status ${status}">${status.toUpperCase()}</span> ${message}`;
        }

        function checkFiles() {
            const requiredFiles = ['index.html', 'style.css', 'script.js'];
            let allExist = true;

            requiredFiles.forEach(file => {
                fetch(file)
                    .then(response => {
                        if (!response.ok) {
                            allExist = false;
                        }
                    })
                    .catch(() => {
                        allExist = false;
                    });
            });

            setTimeout(() => {
                testResults.files = allExist;
                updateStatus('file-check', allExist ? 'success' : 'error',
                    allExist ? 'æ‰€æœ‰å¿…è¦æª”æ¡ˆéƒ½å­˜åœ¨' : 'ç¼ºå°‘å¿…è¦æª”æ¡ˆ');
                updateTestResults();
            }, 1000);
        }

        function checkResources() {
            const resources = [
                'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css',
                'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js',
                'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css'
            ];

            let loadedCount = 0;
            resources.forEach(url => {
                fetch(url)
                    .then(() => loadedCount++)
                    .catch(() => { });
            });

            setTimeout(() => {
                const success = loadedCount === resources.length;
                testResults.resources = success;
                updateStatus('resource-check', success ? 'success' : 'warning',
                    `${loadedCount}/${resources.length} å€‹å¤–éƒ¨è³‡æºè¼‰å…¥æˆåŠŸ`);
                updateTestResults();
            }, 2000);
        }

        function checkJavaScript() {
            try {
                // æ¸¬è©¦åŸºæœ¬ JavaScript åŠŸèƒ½
                const testObj = { test: 'value' };
                const testArray = [1, 2, 3];
                const testFunction = () => 'test';

                if (typeof testObj === 'object' &&
                    Array.isArray(testArray) &&
                    typeof testFunction === 'function') {
                    testResults.javascript = true;
                    updateStatus('js-check', 'success', 'JavaScript åŠŸèƒ½æ­£å¸¸');
                } else {
                    throw new Error('åŸºæœ¬åŠŸèƒ½æ¸¬è©¦å¤±æ•—');
                }
            } catch (error) {
                testResults.javascript = false;
                updateStatus('js-check', 'error', 'JavaScript åŠŸèƒ½ç•°å¸¸');
            }
            updateTestResults();
        }

        function checkMap() {
            // æ¸¬è©¦ Leaflet æ˜¯å¦å¯ç”¨
            if (typeof L !== 'undefined') {
                testResults.map = true;
                updateStatus('map-check', 'success', 'Leaflet åœ°åœ–åº«è¼‰å…¥æˆåŠŸ');
            } else {
                testResults.map = false;
                updateStatus('map-check', 'error', 'Leaflet åœ°åœ–åº«è¼‰å…¥å¤±æ•—');
            }
            updateTestResults();
        }

        function checkResponsive() {
            // æª¢æŸ¥éŸ¿æ‡‰å¼è¨­è¨ˆæ”¯æ´
            const hasViewport = document.querySelector('meta[name="viewport"]');
            const hasMediaQueries = window.matchMedia;

            if (hasViewport && hasMediaQueries) {
                testResults.responsive = true;
                updateStatus('responsive-check', 'success', 'éŸ¿æ‡‰å¼è¨­è¨ˆæ”¯æ´æ­£å¸¸');
            } else {
                testResults.responsive = false;
                updateStatus('responsive-check', 'warning', 'éŸ¿æ‡‰å¼è¨­è¨ˆæ”¯æ´æœ‰é™');
            }
            updateTestResults();
        }

        function updateTestResults() {
            const passed = Object.values(testResults).filter(Boolean).length;
            const total = Object.keys(testResults).length;
            const percentage = Math.round((passed / total) * 100);

            const resultsElement = document.getElementById('test-results');
            resultsElement.innerHTML = `
                <h4>æ¸¬è©¦å®Œæˆåº¦: ${passed}/${total} (${percentage}%)</h4>
                <ul>
                    <li>æª”æ¡ˆå®Œæ•´æ€§: ${testResults.files ? 'âœ…' : 'âŒ'}</li>
                    <li>å¤–éƒ¨è³‡æº: ${testResults.resources ? 'âœ…' : 'âš ï¸'}</li>
                    <li>JavaScript: ${testResults.javascript ? 'âœ…' : 'âŒ'}</li>
                    <li>åœ°åœ–åŠŸèƒ½: ${testResults.map ? 'âœ…' : 'âŒ'}</li>
                    <li>éŸ¿æ‡‰å¼è¨­è¨ˆ: ${testResults.responsive ? 'âœ…' : 'âš ï¸'}</li>
                </ul>
                                ${percentage >= 80 ?
                    '<p style="color: green; font-weight: bold;">ğŸ‰ æ¸¬è©¦é€šéï¼å¯ä»¥æ­£å¸¸ä½¿ç”¨ ç¾æ¨‚åœ°ç”¢</p>' :
                    '<p style="color: orange; font-weight: bold;">âš ï¸ éƒ¨åˆ†åŠŸèƒ½å¯èƒ½æœ‰å•é¡Œï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·š</p>'
                }
            `;
        }

        function runAllTests() {
            // é‡ç½®çµæœ
            testResults = {
                files: false,
                resources: false,
                javascript: false,
                map: false,
                responsive: false
            };

            // åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
            checkFiles();
            checkResources();
            checkJavaScript();
            checkMap();
            checkResponsive();
        }

        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œæ¸¬è©¦
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 500);
        });
    </script>
</body>

</html>